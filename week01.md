# 2-1. 관계형 데이터베이스 개요
## 관계형 데이터베이스와 DBMS
**데이터베이스**
- 데이터의 집합 형식을 갖추지 않아도 엑셀 파일을 모아 둔다면 그것 또한 데이터베이스
**DBMS**
- 데이터를 효과적으로 관리하기 위한 시스템
- 개인이 파일을 여러 개 묶어서 폴더에 보관하면 데이터를 찾고 관리하는데 많은 비용이 발생
-> 시스템적으로 작동하게 만든 시스템(ORACLE, MYSQL etc.)

### 관계형 데이터베이스의 구성 요소 
1. 계정
- 데이터의 접근 제한을 위한 여러 업무별/시스템별 계정이 존재
2. 테이블
- DBMS의 DB 안에서 데이터가 저장되는 형식
3. 스키마
- 테이블이 어떠한 구성으로 되어있는지, 어떠한 정보를 가지고 있는지에 대한 기본적인 구조를 정의

**테이블**

정의 
- 엑셀에서 워크시트처럼 행(row)과 열(col)을 갖는 2차원 구조로 구성, 데이터를 입력하여 저장하는 최소 단위
- 컬럼은 속성이라고도 부름

특징
- 하나의 테이블은 반드시 하나의 유저 소유
- 테이블 간 관계는 1:1, 1:N, N:N
- 테이블명은 중복될 수 없지만, 소유자가 다른 경우 같은 이름으로 생성 가능
- 테이블은 행 단위로 데이터가 입력, 삭제되며 수정은 값의 단위로 가능

### SQL
- 관계형 데이터베이스에서 데이터 조회 및 조작, DBMS 시스템 관리 기능을 명령하는 언어
- 데이터의 정의(DDL), 데이터 조작(DML), 데이터 제어 언어(DCL) 등으로 구분
- SQL 문법은 대소문자 구분 X

### 관계형 데이터베이스 특징
- 데이터의 분류, 정렬, 탐색 속도가 빠름
- 신뢰성이 높고, 데이터의 무결성 보장
- 기존의 작성된 스키마를 수정하기 어려움
- 데이터베이스의 부하를 분석하는 것이 어려움

**데이터 무결성**
- 데이터의 정확성과 일관성을 유지하고, 데이터에 결손과 부정합이 없음을 보장하는 것
- 데이터베이스에 저장된 값과 그것이 표현하는 현실의 비지니스 모델의 값이 일치하는 정확성을 의미
- 데이터 무결성을 유지하는 것이 데이터베이스 관리시스템에 중요한 기능

**데이터 무결성 종류**
1. 개체 무결성: 테이블의 기본키를 구성하는 컬럼은 NULL값이나 중복값을 가질 수 없음
2. 참조 무결성: 외래키 값은 NULL이거나 참조 테이블의 기본키 값과 동일
3. 도메인 무결성: 주어진 속성 값이 정의된 도메인에 속한 값이어야 함
4. NULL 무결성: 특정 속성에 대해 NULL값을 허용하지 않는 특징
5. 고유 무결성: 특정 속성에 대해 값이 중복되지 않는 특징
6. 키 무결성: 하나의 관계에는 적어도 하나의 키가 존재

**ERD**
- 테이블 간 서로의 상관관계를 그림으로 표현한 것
- 구성요소: 엔터티(entity), 관계(relationship), 속성(attribue)
  - *현실 세계의 데이터는 이 3가지 구성요소로 모두 표현 가능*


# 2-2. SELECT문 
**SELECT문의 구조**
- FROM > WHERE > GROUP BY > HAVING > SELECT > ORDER BY
```SQL
SELECT * or 선택할 컬럼명 or 표현식
  FROM 테이블 명 또는 뷰명
 WHERE 조회 조건
 GROUP BY 그룹핑 컬럼명
HAVING 그룹핑 필터링 조건
 ORDER BY 정렬컬럼명 ;
```

- SELECT절에서 표시할 대상 컬럼에 alias 지정 가능
- 원하는 컬럼을 컴마(,)로 나열하여 작성 가능

```sql
SELECT EMPNO AS 사번, 
       ENAME AS 사원이름,
       SAL*1.1 AS NEW_SAL
  FROM EMP;
```
- SAL이라는 컬럼의 값에 1.1배 하여 출력 

**특징 및 주의 사항**
- SELECT문보다 늦게 수행되는 ORDER BY절에서만 컬럼 별칭 사용 가능
- 한글 사용 가능
- 이미 존재하는 예약어는 별칭으로 사용 불가

**별칭에 쌍따옴표가 필요한 경우**
- 공백 포함
- 특수문자 포함('_'제외)
- 입력한 대소문자를 그대로 출력하고자 할 때

**FROM절**
- 테이블을 불러올 테이블명 또는 뷰명 전달

# 2-3. 함수
**함수 정의**
- input value가 있을 경우 그에 맞는 output value를 출력해주는 객체
- from절을 제외한 모든 절에서 사용 가능

**함수 기능**
- 데이터의 계산 수행
- 개별 데이터의 항목 수정
- 표시할 날짜 및 숫자 형식을 지정
- 열 데이터의 유형을 변환

**함수의 종류**
1. 단일행 함수: input과 output의 관계가 1:1
2. 복수행 함수: 여러 건의 데이터를 동시에 입력받아서 하나의 요약값을 리턴(= 그룹합수, 집계함수)

**입/출력값의 타입에 따른 함수 분류**
1. 문자형 함수
- 문자열 결합, 추출, 삭제 등을 수행 
- 단일행 함수 형태
- output은 대부분 문자값(LENGTH, INSTR 제외)
```sql
# 문자형 함수 종류
LOWER(): 문자열을 소문자로 변환
UPPER(): 문자열을 대문자로 변환
SUBSTR(대상, m, n): 문자열 중 m 위치에서 n개 추출
INSTR(대상, 찾을 문자열, m, n): 대상에서 찾을 문자열 위치 반환
RTIRM(): 문자열 중 특정 문자열을 오른쪽에서 삭제
TRIM(): 문자열 중 특정 문자열을 양쪽에서 삭제 
LPAD(대상, n, 문자열): 대상 왼쪽에 문자열을 추가하여 총 n의 길이 리턴
RPAD(대상, n, 문자열): 대상 오른쪽에서 문자열을 추가하여 총 n의 길이 리턴
CONCAT(대상1, 대상2): 문자열 결합
LENGTH(): 문자열 길이 반환
REPLACE(대상, 찾을 문자열, 바꿀 문자열): 문자열 치환 및 삭제
TRANSLATE(대상, 찾을 문자열, 바꿀 문자열): 글자를 1대 1로 치환 
```


2. 숫자형 함수
- 숫자를 입력하면 숫자 값을 반환
- 단일행 함수 형태의 숫자함수
```sql
ABS(): 절댓값
ROUND(숫자, 자리수): 반올림
TRUNCE(숫자, 자리수): 버림
SIGN(): 양수면 1, 음수면 -1, 0이면 0 반환
FLOOR(): 작거나 같은 최대 정수 반환
CEIL(): 크거나 같은 최소 정수 반환
MOD(숫자1, 숫자2): 숫자1/숫자2 후 나머지
POWER(m, n): m의 n 거듭제곱
SQRT(): 루트값 반환 
```

3. 날짜형 함수
- 날짜 연산과 관련된 함수
```sql
# 날짜형 함수 종류 
SYSDATE: 현재 날짜와 시간 리턴 
CURRENT_DATE: 현재 날짜 리턴
CURRENT_TIMESTAMP: 현재 타임스탬프 리턴
ADD_MONTHS(날짜, n): 날짜에서 n개월 후 날짜 리턴
MONTHS_BETWEEN(날짜1, 날짜2): 날짜1과 날짜2의 개월 수 리턴 
LAST_DAY: 주어진 월의 마지막 날짜 리턴
NEXT_DAY(날짜, n): 주어진 날짜 이후 지정된 요일의 첫 번째 날짜 리턴 
ROUND(날짜, 자리수): 날짜 반올림
TRUNC(날짜, 자리수): 날짜 버림
```

4. 변환함수
- 값의 데이터 타입을 변환 *ex) 문자 -> 숫자, 날짜 -> 문자 etc.*
```sql
# 변환함수 종류 
TO_NUMBER(): 숫자 타입으로 변경하여 리턴
TO_CHAR(대상, 포맷): 날짜/숫자의 포맷 변경
TO_DATE(문자, 포맷): 주어진 문자를 포맷 형식에 맞게 읽어 날짜로 리턴
FORMAT(날짜, 포맷): 나라의 포맷 변경
CAST(대상 AS 데이터타입): 대상을 주어진 데이터타입으로 변환 
```

5. 그룹함수
- 다중행 함수
- 여러 값이 input값으로 들어가서 하나의 요약된 값으로 리턴
- GROUP BY와 함께 자주 사용됨 
``` sql
# 그룹함수 종류
COUNT(): 행의 수 리턴
SUM()
AVG()
MIN()
MAX()
VARIANCE(): 분산 리턴
STDDEV(): 표준편차 리턴
```

6. 일반함수
- 기타 함수
```sql
DECODE(대상, 값1, 리턴1, 값2, 리턴2, ..., 그외리턴): 대상이 값1이면 리턴1, 값2면 리턴2.. 
NVL(대상, 치환값): 대상이 null이면 치환값으로 치환하여 리턴
NVL2(대상, 치환값1, 치환값2): 대상이 null이면 치환값2, 아니면 치환값1로 치환하여 리턴
COALESCE(대상1, 대상2, ..., 그외리턴): 대상 중 null이 아닌 값 출력, 모두 null이면 그외리턴값 리턴
ISNULL(대상, 치환값): 대상이 null이면 치환값이 리턴
NULLIF(대상1, 대상2): 두 값이 같으면 null 리턴, 다르면 대상1 리턴
CASE문: 조건별 치환 및 연산 수행
```

# 2-4. WHERE절 
**WHERE절**
- 원하는 조건에 맞는 데이터만 조회하고 싶은 경우 사용
- 여러 조건 동시 전달 가능(AND, OR)
- NULL 조회시 IS NULL / IS NOT NULL 연산자 사용
```sql
SELECT * / 컬럼명 / 표현식
  FROM 테이블명 / 뷰명
 WHERE 조회할 테이블 조건 ;
```
**연산자 종류**
- = / != / > / < / <= / >=
- BETWEEN a AND b
- IN(a, b, c): a거나 b거나 c인 조건 검색
- LIKE: 특정 패턴을 가지고 있는 조건을 검색
- IS NULL / IS NOT NULL: NULL값을 검색 / NULL이 아닌 값을 검색
- A AND B / A OR B / NOT A

**주의사항**
- 문자나 날짜 상수 표현시 반드시 홀따옴표 사용
```sql
# DEPTNO가 10번이면서 SAL이 2000 이상인 직원 출력
SELECT EMPNO, ENAME, SAL, COMM, DEPTNO
  FROM EMP
 WHERE DEPTNO = 10
   AND SAL >= 2000;

# 이름이 SCOTT이거나 SMITH인 직원 출력
SELECT EMPNO, ENAME, SAL, COMM, DEPTNO
  FROM EMP
 WHERE ENAME IN ('SCOTT', 'SMITH')
```

**LIKE 연산자**
- %: 자리수 제한 없는 모든이라는 의미
- _: _하나 당 한 자리수 의미
```sql
ENAME LIKE S%: 이름이 S로 시작하는
ENAME LIKE %S%: 이름에 S를 포함하는 
ENAME LIKE %S: 이름이 S로 끝나는
ENAME LIKE _S%: 이름의 두 번째 글짜가 S인 
ENAME LIKE __S__: 이름 가운데 글자가 S이며 총 5글자


